name: CMake

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

env:
  # Customize the CMake build type here (Release, Debug, RelWithDebInfo, etc.)
  BUILD_TYPE: Release

jobs:
  build:
    runs-on: windows-latest

    permissions:
      contents: read
      packages: read

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v3
      with:
        submodules: 'recursive'

    - name: Setup NuGet
      shell: pwsh
      run: |
        nuget sources add `
          -source "https://nuget.pkg.github.com/PurpleFlowerGarden/index.json" `
          -storepasswordincleartext `
          -name "${env:NUGET_REPOSITORY_ID}" `
          -username "${{ github.repository_owner }}" `
          -password "${{ secrets.GITHUB_TOKEN }}"
        nuget setapikey `
          "${{ secrets.GITHUB_TOKEN }}" `
          -source "${env:NUGET_REPOSITORY_ID}"
        nuget sources

    - name: Find VCPKG
      shell: pwsh
      run: |
	echo ${env:VCPKG_ROOT}

    #- name: Configure
    #  # Configure CMake in a 'build' subdirectory. `CMAKE_BUILD_TYPE` is only required if you are using a single-configuration generator such as make.
    #  # See https://cmake.org/cmake/help/latest/variable/CMAKE_BUILD_TYPE.html?highlight=cmake_build_type
    #  run: cmake -B ${{github.workspace}}/build -DCMAKE_BUILD_TYPE=${{env.BUILD_TYPE}}

    #- name: Build
    #  working-directory: ${{github.workspace}}
    #  shell: pwsh
    #  run: ./build.ps1

    #- name: Test
    #  working-directory: ${{github.workspace}}
    #  shell: pwsh
    #  run: ./run.ps1

